function animate(pendules,dt,enregistrement)

if enregistrement % Initialiser l'enregistrement
    set(gcf,'visible','off')
    filename = input("Veuillez entrer le nom du fichier à enregistrer : ",'s');
    % On assure la bonne extension au fichier
    if length(filename) < 5 | all(filename([end-3:end]) ~= '.mp4')
        filename = [filename '.mp4'];
    end
    % Création du fichier
    vidfile = VideoWriter(filename,'MPEG-4');
    vidfile.FrameRate = 1/dt; % On veut un framerate correspondant à la réalité physique
    open(vidfile);
end

% Boucle de l'animation
for frame = 1:length(pendules{1}{2}) 
    for obj = 1:size(pendules,2) % On veut sélectionner tous les pendules à animer
        set(pendules{obj}{1}(1),'XData',[0,pendules{obj}{2}(frame)],'YData',[0 pendules{obj}{3}(frame)])
        set(pendules{obj}{1}(2),'XData',[pendules{obj}{2}(frame),pendules{obj}{4}(frame)],'YData',[pendules{obj}{3}(frame),pendules{obj}{5}(frame)])
        set(pendules{obj}{1}(3),'XData',pendules{obj}{2}(frame),'YData',pendules{obj}{3}(frame))
        set(pendules{obj}{1}(4),'XData',pendules{obj}{4}(frame),'YData',pendules{obj}{5}(frame))
        drawnow
 
    end
    
    if enregistrement
        frame = getframe(gcf); % On capture le "frame"
        writeVideo(vidfile,frame) % On écrit le "frame" dans le fichier vidéo
    end
    pause(0.01)
end

if enregistrement
    set(gcf,'visible','on')
    close(vidfile);
end

end